(function(){var mydomain=document.domain;var mydomainArr=mydomain.split(".");var mydomainLen=mydomainArr.length;var firstDomain=mydomainArr[mydomainLen-2]+"."+mydomainArr[mydomainLen-1];document.domain=firstDomain})();EventManager={eventMapping:{},on:function(eventName,callback){if(!this.eventMapping[eventName]){this.eventMapping[eventName]=[]}this.eventMapping[eventName].push(callback)},off:function(eventName){if(this.eventMapping[eventName]){delete this.eventMapping[eventName]}},trigger:function(eventName,args){var callbackList=this.eventMapping[eventName]||[];for(var i=0;i<callbackList.length;i++){callbackList[i](args)}}};EventManagerV2={eventMapping:{},on:function(eventName,callback){if(!this.eventMapping[eventName]){this.eventMapping[eventName]=[]}this.eventMapping[eventName].push(callback)},trigger:function(eventName,args){var callbackList=this.eventMapping[eventName]||[];for(var i=0;i<callbackList.length;i++){callbackList[i](args)}}};function encodeScript(str){var s="";if(str.length==0)return"";s=str.replace(/</g,"&lt;");s=s.replace(/>/g,"&gt;");return s}function createWebapiUrl(refUrl){if(refUrl.indexOf("http://")!=-1||refUrl.substring(0,1)=="/"){return refUrl}var mydomain=location.host;var mydomainArr=mydomain.split(".");var mydomainLen=mydomainArr.length;var firstDomain=mydomainArr[mydomainLen-2]+"."+mydomainArr[mydomainLen-1];var host=bs_tita.apiPath||"//webapi."+firstDomain;var absUrl=host+"/api/v1/"+(window.bs_tita&&bs_tita.tenantInfo.Id)+"/"+(window.bs_tita&&bs_tita.loginUserInfo.Id)+"/"+refUrl;return absUrl}function getXSSAjax(callback,iframeUrl){$.getXSSAjaxCallbacks=$.getXSSAjaxCallbacks||[];var frameId="_bs_js_xss_"+iframeUrl;var iframe=document.getElementById(frameId);if(!iframe){iframe=document.createElement("iframe");iframe.id=frameId;iframe.style.display="none";var mydomain=location.host;var mydomainArr=mydomain.split(".");var mydomainLen=mydomainArr.length;var firstDomain=mydomainArr[mydomainLen-2]+"."+mydomainArr[mydomainLen-1];var host=bs_tita.apiPath||"//webapi."+firstDomain;iframeUrl=iframeUrl||host+"/iframe.html";iframe.src=iframeUrl;if(iframe.attachEvent){iframe.attachEvent("onload",loadHandler)}else{iframe.onload=loadHandler}$.getXSSAjaxCallbacks.push(callback);document.body.appendChild(iframe)}else{if($.getXSSAjaxLoaded){callback&&callback()}else{$.getXSSAjaxCallbacks.push(callback)}}function loadHandler(){var domainFields=document.domain.split(".");var len=domainFields.length;document.domain=domainFields[len-2]+"."+domainFields[len-1];$.getXSSAjaxLoaded=true;$.ajaxPrefilter(function(options){var domain=iframe.src.split("/").slice(0,3).join("/");if(options.url.indexOf(domain)==0){$.support.cors=true;options.xhr=function(){var iframeWindow=iframe.contentWindow;return iframeWindow.XMLHttpRequest?new iframeWindow.XMLHttpRequest:iframeWindow.ActiveXObject?new iframeWindow.ActiveXObject("Microsoft.XMLHTTP"):new iframeWindow.XMLHttpRequest}}});for(var i=0,l=$.getXSSAjaxCallbacks.length;i<l;i++){var callback=$.getXSSAjaxCallbacks.pop();callback&&callback()}}}function cursorMoveEnd(input){var len=$(input).val().length;var obj=$(input)[0];if($.browser.msie){var range=obj.createTextRange();range.moveStart("character",len);range.collapse(true);range.select()}else{obj.setSelectionRange(len,len);obj.focus()}}function isEmptyObject(obj){for(var name in obj){return false}return true}function CursorPosition(){this.get=getCursP;this.set=setCursP}function getCursP(textBox){var start=0,end=0;if(typeof textBox.selectionStart=="number"){start=textBox.selectionStart;end=textBox.selectionEnd}else if(document.selection){var range=document.selection.createRange();if(range.parentElement().id==textBox.id){var range_all=document.body.createTextRange();range_all.moveToElementText(textBox);for(start=0;range_all.compareEndPoints("StartToStart",range)<0;start++)range_all.moveStart("character",1);for(var i=0;i<=start;i++){if(textBox.value.charAt(i)=="\n")start++}var range_all=document.body.createTextRange();range_all.moveToElementText(textBox);for(end=0;range_all.compareEndPoints("StartToEnd",range)<0;end++){range_all.moveStart("character",1)}for(var i=0;i<=end;i++){if(textBox.value.charAt(i)=="\n")end++}}}return{start:start,end:end}}function setCursP(ctrl,start,end){end=end||start;if(ctrl.setSelectionRange){ctrl.focus();ctrl.setSelectionRange(start,end)}else if(ctrl.createTextRange){var range=ctrl.createTextRange();range.collapse(true);range.moveEnd("character",end);range.moveStart("character",start);range.select()}}function cutStrBybyte(str,len){if(!str||!len)return"";var a=0,i=0,temp="";for(i=0;i<str.length;i++){if(str.charCodeAt(i)>255){a+=2}else{a++}if(a>len){temp+="...";return temp}temp+=str.charAt(i)}return str}